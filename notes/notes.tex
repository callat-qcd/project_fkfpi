\documentclass[prd,tightenlines,preprintnumbers,showpacs,superscriptaddress,notitlepage,nofootinbib,eqsecnum,floatfix,notitlepage]{revtex4-1}

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{braket}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{float}
\usepackage[utf8]{inputenc} % supports umlaut natively, eg
\usepackage{hyperref} % adds hyperlinks
\usepackage{csvsimple} % Easily add csv file as table

\newcount\hour \newcount\hourminute \newcount\minute 
\hour=\time \divide \hour by 60
\hourminute=\hour \multiply \hourminute by 60
\minute=\time \advance \minute by -\hourminute
\newcommand{\mydate}{\ \today \ - \number\hour :\number\minute}


\begin{document}
	
\title{$F_K / F_\pi$ Notes}
\author{Nolan Miller}
\date{\mydate}


\begin{abstract}
In these notes, we explain our general fitting strategy for determining $F_K / F_\pi$. The description of the fit functions is mostly plagiarized from Andr√©'s notes (though edited some for clarity), so kudos to him.
\end{abstract}
\maketitle


\section{Fit Functions}

In general, our fits are of the form
\begin{equation}
\left(\frac{F_K}{F_\pi}\right)_\text{lattice} = \left(\frac{F_K}{F_\pi}\right)_\text{model}^{(n_V)} + 
\delta\left(\frac{F_K}{F_\pi}\right)_\text{NNLO} + 
\delta\left(\frac{F_K}{F_\pi}\right)_\text{NNNLO}
\end{equation}
where the $n_V$ denotes to which order we fit the finite volume effects.
\subsection{Special Functions}
For reference, we use the following special functions in our fits, which encapsulate the finite volume dependence. The values for the $c_n$'s are given in Table \ref{tab:cN_weights}.
\begin{align}
\mathcal{I}(m) &= \frac{m^2}{(4\pi)^2} \ln \left( \frac{m^2}{\mu^2} \right)
+ \frac{m^2}{4\pi^2} \sum_{|\mathbf{n}|\neq0} \frac{c_n}{mL|\mathbf{n}|} K_1(mL|\mathbf{n}|) \\
%%%
d\mathcal{I}(m) &=
\frac{1}{(4\pi)^2} + \frac{\mathcal{I}(m)}{m^2}
+\sum_{|\mathbf{n}|\neq0} \frac{c_n}{(4\pi)^2} \left[
\frac{2K_1(mL|\mathbf{n}|)}{mL|\mathbf{n}|}
-K_0(mL|\mathbf{n}|)
-K_2(mL|\mathbf{n}|)\right] \\
%%%
\mathcal{K}(m,M) &= \frac{1}{M^2 - m^2} \Big[ \mathcal{I}(M) - \mathcal{I}(m) \Big] \\
%%%
\mathcal{K}_{21}(m,M) &=
\frac{1}{(M^2 - m^2)^2} \Big[ \mathcal{I}(M) - \mathcal{I}(m) \Big]
-\frac{1}{M^2 - m^2} d\mathcal{I}(m) \\
%%%
\mathcal{K}(m_1,m_2,m_3) &= \frac{1}{m_1^2 - m_2^2}\frac{1}{m_1^2-m_3^2} \mathcal{I}(m_1)
+\frac{1}{m_2^2 - m_1^2} \frac{1}{m_2^2 - m_3^2} \mathcal{I}(m_2)
\nonumber\\&\phantom{=}
+\frac{1}{m_3^2 - m_1^2} \frac{1}{m_3^2 - m_2^2} \mathcal{I}(m_3)
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%
% cN table
\begin{table}
	\begin{ruledtabular}
		\begin{tabular}{c|cccccccccc}
			$|\mathbf{n}|$& 1 & $\sqrt{2}$& $\sqrt{3}$& $\sqrt{4}$& $\sqrt{5}$& $\sqrt{6}$& $\sqrt{7}$& $\sqrt{8}$& $\sqrt{9}$& $\sqrt{10}$\\
			\hline
			$c_n$& 6&12& 8& 6& 24& 24& 0& 12& 30& 24
		\end{tabular}
	\end{ruledtabular}
	\caption{\label{tab:cN_weights}
		Finite volume weight factors for the first few finite volume modes.
	}
\end{table}



\subsection{NLO chiral extrapolation formulae}

In these expressions, the $\eta$ meson mass can be approximated with the $SU(3)$ Gell-Mann--Okubo formula
\begin{equation}
m_\eta^2 = \frac{4}{3} m_K^2 - \frac{1}{3}m_\pi^2\, .
\end{equation}
The $X$ mass appearing in the MA formulae is
\begin{equation}
m_X^2 = m_\eta + a^2 \Delta_{\rm I}
\end{equation}
where $a^2 \Delta_{\rm I}$ is the taste-identity mass splitting which MILC has determined~\cite{Bazavov:2012xda}.

The mixed meson masses are given by
\begin{equation}
m_{val,sea}^2 = \frac{1}{2}m_{val,val}^2 + \frac{1}{2}m_{sea,sea,5}^2 + a^2 \Delta_{\rm Mix}
\simeq m_{val,val}^2 + a^2 \Delta_{\rm Mix}\, .
\end{equation}
For brevity, we label a quark $j$ for sea-up, $u$ for valence-up, $r$ for sea-strange, and $s$ for valence-strange.

Given the quark mass tuning we have done, at LO in MA EFT~\cite{Chen:2006wf}, all partial quenching parameters are given by the taste-identity splitting
\begin{equation}
\Delta_{rs}^2 = \Delta_{ju}^2 = a^2 \Delta_{\rm I}\, .
\end{equation}

We can plot the splitting over flavors and pion masses, and see how well this LO relation holds.  We will also fit using the full on-shell masses as they appear in the MA formula as well as use an average mixed-meson mass splitting, $a^2 \Delta_{\rm mix}$, averaged over the flavors and ensembles (possibly replace the average with extrapolation).





\subsection{Models}
In the following descriptions of the models, we make use of the definitions
\begin{equation}
\epsilon_\pi^2 = \frac{m_\pi^2}{\Lambda_\chi^2} \qquad
\epsilon_K^2 = \frac{m_K^2}{\Lambda_\chi^2} \qquad
\epsilon_a^2 = \frac{a^2}{16 \pi ^2\omega_0^2} \qquad
\end{equation}
where we set $\Lambda_\chi^2$ to $F_\pi^2$, $F_K^2$, or $F_\pi F_K$.

\subsubsection{NLO MA}
For these fits, we will do
\begin{equation}
\left(\frac{F_K}{F_\pi}\right)_\text{MA} = \frac{F_K^\text{nlo}}{F_\pi^\text{nlo}}
\end{equation}
where
\begin{align}
\frac{F_\pi^{\rm nlo}}{F_0} &= 1
- \frac{\mathcal{I}(m_{ju})}{F^2}
-\frac{\mathcal{I}(m_{ru})}{2F^2}
+4 \epsilon_\pi^2 (4\pi)^2 (L_4 + L_5)
+8 \epsilon_K^2 (4\pi)^2 L_4
\end{align}

\begin{align}
\frac{F_K^{\rm nlo}}{F_0} &= 1
-\frac{\mathcal{I}(m_{ju})}{2F^2}
+\frac{\mathcal{I}(m_\pi)}{8F^2}
-\frac{\mathcal{I}(m_{ru})}{4F^2}
-\frac{\mathcal{I}(m_{sj})}{2F^2}
-\frac{\mathcal{I}(m_{rs})}{4F^2}
+\frac{\mathcal{I}(m_{ss})}{4F^2}
-\frac{3\mathcal{I}(m_X)}{8F^2}
\nonumber\\&\phantom{=}
+4\epsilon_\pi^2 L_4 + 4\epsilon_K^2(L_5 + 2L_4)
\nonumber\\&\phantom{=}
+\Delta_{ju}^2 \left[ -\frac{d\mathcal{I}(m_\pi)}{8F^2} + \frac{\mathcal{K(}m_\pi,m_X)}{4F^2} \right]
-\Delta_{ju}^4 \frac{\mathcal{K}_{21}(m_\pi,m_X)}{24 F^2}
\nonumber\\&\phantom{=}
+\Delta_{ju}^2\Delta_{rs}^2 \left[ \frac{\mathcal{K}(m_\pi, m_{ss}, m_X)}{6F^2}
+\frac{\mathcal{K}_{21}(m_{ss},m_X)}{12F^2} \right]
\nonumber\\&\phantom{=}
+\Delta_{rs}^2 \left[
\frac{\mathcal{K}(m_{ss},m_X)}{4F^2} 
-\frac{\mathcal{K}_{21}(m_{ss},m_X) m_K^2}{6F^2}
+\frac{\mathcal{K}_{21}(m_{ss},m_X) m_\pi^2}{6F^2}
\right]
\end{align}


\subsubsection{NLO MA Taylor expanded ratio}
For these fits, 

\begin{align}\label{eq:fkfpi_ma}
\left(\frac{F_K}{F_\pi}\right)_\text{MA Taylor} &= 1
+\frac{\mathcal{I}(m_{ju})}{2F^2}
+\frac{\mathcal{I}(m_\pi)}{8F^2}
+\frac{\mathcal{I}(m_{ru})}{4F^2}
-\frac{\mathcal{I}(m_{sj})}{2F^2}
+\frac{\mathcal{I}(m_{ss})}{4F^2}
-\frac{\mathcal{I}(m_{rs})}{4F^2}
-\frac{3\mathcal{I}(m_X)}{8F^2}
\nonumber\\&\phantom{=}
+\Delta_{ju}^2 \left[ -\frac{d\mathcal{I}(m_\pi)}{8F^2} + \frac{\mathcal{K(}m_\pi,m_X)}{4F^2} \right]
-\Delta_{ju}^4 \frac{\mathcal{K}_{21}(m_\pi,m_X)}{24 F^2}
\nonumber\\&\phantom{=}
+\Delta_{ju}^2\Delta_{rs}^2 \left[ \frac{\mathcal{K}(m_\pi, m_{ss}, m_X)}{6F^2}
+\frac{\mathcal{K}_{21}(m_{ss},m_X)}{12F^2} \right]
\nonumber\\&\phantom{=}
+\Delta_{rs}^2 \left[
\frac{\mathcal{K}(m_{ss},m_X)}{4F^2} 
-\frac{\mathcal{K}_{21}(m_{ss},m_X) m_K^2}{6F^2}
+\frac{\mathcal{K}_{21}(m_{ss},m_X) m_\pi^2}{6F^2}
\right]
\nonumber\\&\phantom{=}
+ 4 (4\pi)^2 L_5 \frac{m_K^2 - m_\pi^2}{(4\pi F)^2}
\end{align}

\subsubsection{NLO $\chi$PT}
For these fits, we will do
\begin{equation}
\left(\frac{F_K}{F_\pi}\right)_\text{$\chi$PT} = \frac{F_K^{\rm nlo}}{F_\pi^{\rm nlo}}
\end{equation}
where
\begin{align}
\frac{F_\pi^{\rm nlo}}{F_0} &= 1
- \frac{\mathcal{I}(m_\pi)}{F^2}
-\frac{1}{2}\frac{\mathcal{I}(m_K)}{F^2}
+4 \epsilon_\pi^2 (4\pi)^2 (L_4 + L_5)
+8 \epsilon_K^2 (4\pi)^2 L_4 \, , \\
\frac{F_K^{\rm nlo}}{F_0} &= 1
-\frac{3}{8}\frac{\mathcal{I}(m_\pi)}{F^2}
-\frac{3}{4}\frac{\mathcal{I}(m_K)}{F^2}
-\frac{3\mathcal{I}(m_\eta)}{8F^2}
+4\epsilon_\pi^2 L_4 + 4\epsilon_K^2(L_5 + 2L_4)
\end{align}


\subsubsection{NLO $\chi$PT Taylor expansion}
For these fits, 
\begin{align}\label{eq:fkfpi_chpt}
\left(\frac{F_K}{F_\pi}\right)_\text{$\chi$PT Taylor} &= 1
+\frac{5}{8} \frac{\mathcal{I}(m_\pi)}{F^2}
-\frac{1}{4} \frac{\mathcal{I}(m_K)}{F^2}
-\frac{3}{8} \frac{\mathcal{I}(m_\eta)}{F^2}
%\nonumber\\&\phantom{=}
+4(\epsilon_K^2 - \epsilon_\pi^2) (4\pi)^2 L_5
%\nonumber\\&\phantom{=}
+ \delta_{c.t.}^{\rm NNLO}
\end{align}

\subsubsection{NLO MA Taylor (old)}
This fit was taken from (17) of \cite{Berkowitz:2017opd}. {\color{red} (To do: add to notes.)}




\subsection{Corrections}

\subsubsection{NNLO \& NNNLO counter terms}
The NNLO and NNNLO counter terms are formed by taking powers of $\epsilon^2_\xi$ ($\xi = K, \pi, a$), along with $(\epsilon_K^2 - \epsilon_\pi^2)$ (which ensures $F_K / F_\pi$ tends to 1 in the chiral limit), to the desired order. For NNLO, we take one power of $\epsilon^2_\xi$ and one power of $(\epsilon_K^2 - \epsilon_\pi^2)$. 
\begin{equation}
\delta\left(\frac{F_K}{F_\pi}\right)_\text{NNLO} = \bigg[ 
\epsilon_a^2  A_{a}
+\epsilon_K^2  A_{K}
+\epsilon_\pi^2  A_{\pi}
\bigg] (\epsilon_K^2 - \epsilon_\pi^2)
\end{equation}
One might expect a term like $(\epsilon_K^2 - \epsilon_\pi^2)^2 A_{\chi}$ to show up in the NNLO expansion; however, this term is already covered by $[\epsilon_K^2  A_{K}+\epsilon_\pi^2  A_{\pi}] (\epsilon_K^2 - \epsilon_\pi^2)$.

For NNNLO, we take two powers of $\epsilon^2_\xi$ and one power of $(\epsilon_K^2 - \epsilon_\pi^2)$ (and vice-versa).
\begin{align}
\delta\left(\frac{F_K}{F_\pi}\right)_\text{NNNLO} &= \bigg[
\epsilon_a^4  A_{a, a} + \epsilon_a^2 \epsilon_K^2  A_{a, K} + \epsilon_a^2 \epsilon_\pi^2  A_{a, \pi} \\ \nonumber
&\phantom{[ =} + \epsilon_K^4  A_{K, K} + \epsilon_K^2 \epsilon_\pi^2  A_{K, \pi} \\ \nonumber
&\phantom{[ =} + \epsilon_\pi^4  A_{\pi, \pi} \bigg] (\epsilon_K^2 - \epsilon_\pi^2)
\end{align}

Notice that the lattice spacing and $am_\xi$ ($\xi \in \{\pi, K, \eta\}$) corrections are included in these counterterms. For example, the term $\epsilon^2_a (\epsilon^2_K - \epsilon^2_\pi)$ accounts for the lowest order lattice spacing correction. Further note that our choice of action (Domain wall) means that the theory will automatically be $\mathcal{O}(a)$ improved~\cite{Berkowitz:2017opd}, hence the lack of terms at that order.



%%%%%%%%%%%%%%%%%%
%%%%% FIT STRATEGY
%%%%%%%%%%%%%%%%%%
\section{Fit Strategy}

From inspections, one sees that the fit depends on the pion, kaon, and mixed meson masses; the taste-identity splitting $\Delta_{rs}^2 = \Delta_{ju}^2 = a^2 \Delta_\text{I}$; the lattice spacing $a$; the Wilson flow scale $w_0$; and the pion and kaon decay constants. First we briefly explain how these quantities were determined, then how we can use them to determine $F_K / F_\pi$ at the physical point.


\subsection{Meson masses}
The meson masses are determined by fitting the spectral decomposition of the meson two-point correlation functions.
\begin{equation}
C(t) = \sum_n Z^{(PS)}_{n} Z^{(SS)}_{n} \left( e^{-E_n t} + e^{-E(T-t)} \right)
\end{equation}

Usually it's sufficient to fit only a single exponential, so we only need to choose the start and end times for our fit. Further, by symmetrically fitting the interval $[t, T - t]$, we reduce these three fit choices to only one -- determining the start time.

Once the mass has been determined over the full ensemble (boot0), the correlation function is resampled $N$ times to form $N$ bootstrap resamples. These bootstrap resamples are then fit over the same time range as the full ensemble and the results are saved, giving us a list of masses for bootstrapping.

\subsection{Taste-identity splitting}
As previously stated, this quantity has been determined by MILC~\cite{Bazavov:2012xda}.

\subsection{Wilson flow scale $\omega_0$}
The Wilson flow-derived quantity $\omega_0$ allows for high-precision scale setting~\cite{Borsanyi:2012zs}. In general, one can measure the lattice spacing by comparing the lattice value of some (dimensionful) observable to its experimental value, eg, 
\begin{equation}
a = \frac{(a m_\Omega)^\text{latt}}{m_\Omega^\text{exp}}
\end{equation}
which can be converted to physical units by multiplying by $\hbar c$ (ie, $a_\text{phys} = a \hbar c$). Similarly, one can determine $\omega_0$ by measuring
\begin{equation}
w_0 = \frac{(w_0 m_\Omega)^\text{latt}}{m_\Omega^\text{exp}} \, , 
\end{equation}
a task currently underway in another project.  {\color{red} (Is this right?)} In particular, given the following observable
\begin{equation}
W(t) \equiv t \frac{d}{dt} \Big[ t^2 \langle E(t) \rangle \Big] \, ,
\end{equation}
the scale $w_0$ is the value such that 
\begin{equation}
W(t) \Big|_{t=w_0^2} = 0.3 \, .
\end{equation}

For the purpose of this project, we take $w_0 = 0.175(10)$, which is a conservative estimate taken from current progress on scale setting. 

\begin{figure}
	\includegraphics[width=0.75\textwidth]{./../figs/w0_comparison.pdf}
	\caption{Current results on scale setting. Notice that our conservative choice for $w_0$ contains all the models in the figure and then some.}
\end{figure}



\subsection{The pion and kaon decay constants, $F_K$ and $F_\pi$}
{\color{red} (How are these determined?)}






\section{The Weeds}
The actual fit here is performed in lattice units, not physical units, which is possible since the ratio $F_K / F\pi$ is dimensionless.

\subsection{Selection of Prior}
Barring some good physical argument for the expected value of the priors, we use the following heuristic.
\begin{enumerate}
	\item At NLO, the most naive guess is that the LECs $L_4$ and $L_5$ should be order 1. Running the fit a few times, we quickly discover that these LECs are a few orders of magnitude smaller. Therefore, refining our priors for $L_4$ and $L_5$, we set \texttt{p[`L\_4'] = 0(0.001)} and \texttt{p[`L\_5'] = 0(0.001)}. In practice this width extends about an order of magnitude outside our results for $L_4$ and $L_5$, regardless of NLO model chosen.
	\item To set the NNLO priors, we first determine the order of magnitude of the $\epsilon^2_\xi (\epsilon^2_K - \epsilon^2_\pi)$ terms. For example, $\epsilon^2_a (\epsilon^2_K - \epsilon^2_\pi) \sim 10^{-3}$. We center our prior at 0, but set it wide enough such that the upper/lower ends of the uncertainty interval could produce an LEC $A_\xi$ st $\epsilon^2_\xi A_\xi  (\epsilon^2_K - \epsilon^2_\pi) \sim 10^{-2}$, which ensures that the prior doesn't exclude the LEC from contributing at the percent level. In the case of $ \epsilon^2_a (\epsilon^2_K - \epsilon^2_\pi)$, we would set \texttt{p[`A\_a'] = 0(10)}. The procedure is similar for the NNNLO LECs, with us again setting the priors st the LECs can potentially contribute at the percentile level.
\end{enumerate}
While this procedure potentially allows all the NNLO and NNNLO LECs to contribute to the fits, it does lead to some pretty absurd results when taken at face value; eg, setting \texttt{p[`A\_aa'] = 0(100000)}, as one would do as described above, results in a fit of $A_{a, a} = -4926 (11908)$. Fortunately, the \texttt{logGBF} of these fits are correspondingly penalized.

\subsection{Shifting lattice data to physical point}
Notice that the fit of $F_K/F_\pi$ depends on multiple input parameters: $\epsilon^2_\pi$, $w_0$, $a$, etc; that is, we are fitting a many-dimensional surface, so in order to plot $F_k/F_\pi$ vs some parameter, we must carefully take a slice of that surface. In our case, we fit $F_K / F_\pi$ at the physical point with the exception of some input parameters, which we allow to vary.  

Of course, our set of data is not at the physical point, so we must account for this when making these plots. We therefore ``shift" the lattice data to the physical point (while allowing a single parameter to vary) using the following heuristic. Let $\{p_j\} = \{\epsilon^2_\pi, w_0, a, \cdots\}$ be the set of input parameters in the fit for some ensemble and $\{p^*_j\}$ the physical value of these parameters. Now suppose we are interested in the dependence of $F_K / F_\pi$ on some subset of the parameters $\{q_k\}$. Then to shift the data to the physical point without shifting $\{q_k\}$, we calculate
\begin{equation}
\left( \frac{F_K}{F_\pi} \right)_\text{shifted data} =
\left( \frac{F_K}{F_\pi} \right)_\text{data}
+ \left( \frac{F_K}{F_\pi} \right) \bigg|_{\text{fit at } \{p^*_j, q_k\}}
- \left( \frac{F_K}{F_\pi} \right) \bigg|_{\text{fit at } \{p_j, q_k\}} \, .
\end{equation}

Alternatively, one often uses the ratio instead.

\begin{equation}
\left( \frac{F_K}{F_\pi} \right)_\text{shifted data} =
\left( \frac{F_K}{F_\pi} \right)_\text{data}
\Bigg[ \left( \frac{F_K}{F_\pi} \right) \bigg|_{\text{fit at } \{p^*_j, q_k\}}
\bigg/ \left( \frac{F_K}{F_\pi} \right) \bigg|_{\text{fit at } \{p_j, q_k\}} \, \Bigg] .
\end{equation}

I haven't noticed a visible difference in using one versus the other.


\section{Fit Results}
Here we present the results for each of the fits.

\begin{figure}
	\includegraphics[width=0.9\textwidth]{./../figs/fit_comparison.pdf}
	\caption{Extrapolations of $F_K/F_\pi$ to the physical point for the various models, with the FLAG result shown as a red band. Without a better selection of priors for the NNLO and NNNLO LECs, the NNLO and NNNLO fits cannot be tightly determined.}
\end{figure}

\csvautotabular[respect all]{"./../results/fit"_"results".csv}


\foreach \model in {ma, ma-taylor, ma-old, xpt, xpt-taylor}
{
	\subsection{\tt \model}
	\foreach \order in {nlo, nnlo, nnnlo}
	{
		\begin{figure}[H]
			\caption{\model (\order)}
			\includegraphics[width=\textwidth, page=3]{"./../figs/fits/\model"_"\order".pdf}
		\end{figure}
	}
}

\bibliography{notes}

\end{document}

